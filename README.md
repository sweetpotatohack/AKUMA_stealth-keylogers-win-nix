# ğŸ”¥ğŸ’€ Advanced Stealth Keyloggers ğŸ’€ğŸ”¥

![Version](https://img.shields.io/badge/version-2.0-red.svg)
![Language](https://img.shields.io/badge/language-C++-blue.svg)
![Platform](https://img.shields.io/badge/platform-Windows%20%7C%20Linux-green.svg)
![License](https://img.shields.io/badge/license-Educational-yellow.svg)

> **Advanced cross-platform keyloggers designed for security competitions and penetration testing**

```
    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•—  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•—  â–ˆâ–ˆâ•—
    â–ˆâ–ˆâ•”â•â•â•â•â•â•šâ•â•â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘  â•šâ•â•â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘
    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘
    â•šâ•â•â•â•â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•”â•â•â•  â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘
    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘
    â•šâ•â•â•â•â•â•â•   â•šâ•â•   â•šâ•â•â•â•â•â•â•â•šâ•â•  â•šâ•â•â•šâ•â•â•â•â•â•â•â•šâ•â•   â•šâ•â•  â•šâ•â•
                                                            
    â–ˆâ–ˆâ•—  â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•—   â–ˆâ–ˆâ•—â–ˆâ–ˆâ•—      â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—
    â–ˆâ–ˆâ•‘ â–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•”â•â•â•â•â•â•šâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â•â•â• â–ˆâ–ˆâ•”â•â•â•â•â• â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â•â•â•
    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â• â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—   â•šâ–ˆâ–ˆâ–ˆâ–ˆâ•”â• â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—
    â–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•— â–ˆâ–ˆâ•”â•â•â•    â•šâ–ˆâ–ˆâ•”â•  â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•  â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â•šâ•â•â•â•â–ˆâ–ˆâ•‘
    â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘
    â•šâ•â•  â•šâ•â•â•šâ•â•â•â•â•â•â•   â•šâ•â•   â•šâ•â•â•â•â•â•â• â•šâ•â•â•â•â•â•  â•šâ•â•â•â•â•â•  â•šâ•â•â•â•â•â• â•šâ•â•â•â•â•â•â•â•šâ•â•  â•šâ•â•â•šâ•â•â•â•â•â•â•
                                                                                        
    "The art of invisible keystroke capture" - by sweetpotatohack
```

## âš ï¸ Legal Disclaimer

**âš¡ THIS TOOL IS FOR EDUCATIONAL AND AUTHORIZED TESTING PURPOSES ONLY âš¡**

This software is intended EXCLUSIVELY for:
- ğŸ† **Security competitions and CTF events**
- ğŸ”’ **Authorized penetration testing with written permission**
- ğŸ“š **Educational and research purposes in controlled environments**
- ğŸ§ª **Malware analysis and security research**

**âŒ DO NOT USE on systems you don't own or without explicit written permission!**
- Unauthorized access to computer systems is illegal
- The authors are not responsible for any misuse
- Always comply with local laws and regulations

## ğŸš€ Features Overview

### ğŸ”¥ Windows Keylogger
- âš¡ **Low-level keyboard hooks** (WH_KEYBOARD_LL)
- ğŸ›¡ï¸ **Multiple anti-debugging techniques** (PEB, timing, remote debugger)
- ğŸ‘¤ **Process hiding and masquerading**
- ğŸ”§ **Windows Service installation** with persistence
- ğŸ“ **Registry-based persistence** mechanisms
- ğŸ” **XOR encrypted log storage**
- ğŸ–¥ï¸ **Anti-VM and sandbox detection**
- ğŸ”’ **Memory protection** against dumping

### ğŸ§ Linux Keylogger
- âŒ¨ï¸ **Direct input device monitoring** (/dev/input/eventX)
- ğŸ¥· **Process name masquerading** (kthreadd)
- ğŸ‘» **Daemon mode operation** with full stealth
- ğŸš« **Anti-ptrace protection**
- ğŸ”§ **Systemd service persistence**
- â° **Crontab backup persistence**
- ğŸ–¼ï¸ **X11 window title capture**
- ğŸ” **Encrypted logging system**

### ğŸ¯ Common Advanced Features
- ğŸ” **XOR encryption** of all logged data
- â° **Timestamp and window context** logging
- ğŸ”„ **Multiple persistence mechanisms**
- ğŸ›¡ï¸ **Anti-analysis techniques**
- âš¡ **Minimal resource footprint**
- ğŸ”§ **Cross-compilation support**

## ğŸ“ Repository Structure

```
stealth-keyloggers/
â”œâ”€â”€ ğŸ—ï¸  src/                      # Ğ˜ÑÑ…Ğ¾Ğ´Ğ½Ñ‹Ğ¹ ĞºĞ¾Ğ´
â”‚   â”œâ”€â”€ windows_keylogger.cpp      # Windows Ñ€ĞµĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ
â”‚   â”œâ”€â”€ linux_keylogger.cpp       # Linux Ñ€ĞµĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ  
â”‚   â”œâ”€â”€ evasion_techniques.h       # ĞĞ±Ñ‰Ğ¸Ğµ Ñ‚ĞµÑ…Ğ½Ğ¸ĞºĞ¸ Ğ¾Ğ±Ñ…Ğ¾Ğ´Ğ°
â”‚   â””â”€â”€ decrypt_logs.cpp          # Ğ£Ñ‚Ğ¸Ğ»Ğ¸Ñ‚Ğ° Ñ€Ğ°ÑÑˆĞ¸Ñ„Ñ€Ğ¾Ğ²ĞºĞ¸ Ğ»Ğ¾Ğ³Ğ¾Ğ²
â”‚
â”œâ”€â”€ ğŸ› ï¸  build/                    # Ğ¡ĞºÑ€Ğ¸Ğ¿Ñ‚Ñ‹ ÑĞ±Ğ¾Ñ€ĞºĞ¸
â”‚   â”œâ”€â”€ build_windows.bat         # Ğ¡Ğ±Ğ¾Ñ€ĞºĞ° Windows Ğ²ĞµÑ€ÑĞ¸Ğ¸
â”‚   â””â”€â”€ build_linux.sh           # Ğ¡Ğ±Ğ¾Ñ€ĞºĞ° Linux Ğ²ĞµÑ€ÑĞ¸Ğ¸
â”‚
â”œâ”€â”€ ğŸ“š docs/                       # Ğ”Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ°Ñ†Ğ¸Ñ
â”‚   â”œâ”€â”€ TECHNIQUES.md             # Ğ”ĞµÑ‚Ğ°Ğ»ÑŒĞ½Ñ‹Ğµ Ñ‚ĞµÑ…Ğ½Ğ¸ĞºĞ¸ Ğ¾Ğ±Ñ…Ğ¾Ğ´Ğ°
â”‚   â”œâ”€â”€ DEPLOYMENT.md             # Ğ¡Ñ‚Ñ€Ğ°Ñ‚ĞµĞ³Ğ¸Ğ¸ Ñ€Ğ°Ğ·Ğ²ĞµÑ€Ñ‚Ñ‹Ğ²Ğ°Ğ½Ğ¸Ñ
â”‚   â””â”€â”€ KEYLOGGER_README.md      # Ğ”ĞµÑ‚Ğ°Ğ»ÑŒĞ½Ğ¾Ğµ Ğ¾Ğ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ
â”‚
â”œâ”€â”€ ğŸ“– README.md                   # ĞÑĞ½Ğ¾Ğ²Ğ½Ğ°Ñ Ğ´Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ°Ñ†Ğ¸Ñ (ÑÑ‚Ğ¾Ñ‚ Ñ„Ğ°Ğ¹Ğ»)
â”œâ”€â”€ ğŸ“– USAGE.md                    # Ğ˜Ğ½ÑÑ‚Ñ€ÑƒĞºÑ†Ğ¸Ñ Ğ¿Ğ¾ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ
â”œâ”€â”€ ğŸ—ï¸  ARCHITECTURE.md            # ĞÑ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ° Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ğ°
â””â”€â”€ ğŸ”§ .gitignore                 # Git ignore Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ»Ğ°
```

**ĞŸÑ€Ğ¸Ğ¼ĞµÑ‡Ğ°Ğ½Ğ¸Ğµ:** Ğ‘Ğ¸Ğ½Ğ°Ñ€Ğ½Ğ¸ĞºĞ¸ (`*.exe`, `stealth_keylogger`, `decrypt_logs`) Ğ¸ ÑĞºÑ€Ğ¸Ğ¿Ñ‚Ñ‹ ÑƒÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ¸ Ğ³ĞµĞ½ĞµÑ€Ğ¸Ñ€ÑƒÑÑ‚ÑÑ Ğ¿Ñ€Ğ¸ ÑĞ±Ğ¾Ñ€ĞºĞµ Ğ¸ Ğ½Ğµ ĞºĞ¾Ğ¼Ğ¼Ğ¸Ñ‚ÑÑ‚ÑÑ Ğ² Ñ€ĞµĞ¿Ğ¾Ğ·Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ¹.

## âš¡ Quick Start

### ğŸ”§ Prerequisites

**Linux (for cross-compilation):**
```bash
# Install build dependencies
sudo apt-get update
sudo apt-get install build-essential mingw-w64 upx-ucl xdotool git
```

**Windows:**
```cmd
# Install MinGW or Visual Studio Build Tools
# Download UPX packer (optional)
```

### ğŸ“¥ Clone Repository

```bash
# Clone the private repository
git clone https://github.com/sweetpotatohack/stealth-keyloggers.git
cd stealth-keyloggers
```

### ğŸ—ï¸ Build Instructions

#### ğŸ§ Linux Build

```bash
# Make build script executable
chmod +x build/build_linux.sh

# Compile Linux keylogger
./build/build_linux.sh

# Output files:
# - stealth_keylogger (main executable)
# - decrypt_logs (decryption tool)
# - install_linux.sh (installer)
# - uninstall_linux.sh (uninstaller)
```

#### ğŸªŸ Windows Build (Cross-compilation)

```bash
# Make build script executable
chmod +x build/build_windows.bat

# Compile Windows keylogger
./build/build_windows.bat

# Output files:
# - stealth_keylogger.exe (main executable)
# - decrypt_logs.exe (decryption tool)
# - install_service.bat (service installer)
```

## ğŸš€ Usage & Deployment

### ğŸ§ Linux Deployment

#### Manual Execution
```bash
# Direct execution (requires root)
sudo ./stealth_keylogger
```

#### System Installation
```bash
# Install as system service
sudo ./install_linux.sh

# Check service status
sudo systemctl status ksysmon.service

# View logs
sudo journalctl -u ksysmon.service
```

#### Log Decryption
```bash
# Decrypt captured logs
./decrypt_logs /tmp/.sys_log

# Output format:
# 2023-10-16 14:30:15 | Terminal | sudo apt install keylogger-detector[ENTER]
```

#### Uninstallation
```bash
# Complete removal
sudo ./uninstall_linux.sh
```

### ğŸªŸ Windows Deployment

#### Manual Execution
```cmd
# Run as Administrator
stealth_keylogger.exe
```

#### Service Installation
```cmd
# Install as Windows Service (Administrator required)
install_service.bat

# Check service
sc query WindowsUpdate
net start WindowsUpdate
```

#### Log Decryption
```cmd
# Decrypt logs
decrypt_logs.exe "C:\Users\%USERNAME%\AppData\Local\Temp\sys_backup.txt"
```

## ğŸ¥· ĞŸĞ¾Ñ‡ĞµĞ¼Ñƒ Ğ½Ğµ Ğ¿Ğ°Ğ»Ğ¸Ñ‚ÑÑ Ğ°Ğ½Ñ‚Ğ¸Ğ²Ğ¸Ñ€ÑƒÑĞ°Ğ¼Ğ¸? (Ğ¢ĞµÑ…Ğ½Ğ¸ĞºĞ¸ ÑĞºÑ€Ñ‹Ñ‚Ğ½Ğ¾ÑÑ‚Ğ¸)

### ğŸ” ĞĞ±Ñ…Ğ¾Ğ´ ÑÑ‚Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¾Ğ³Ğ¾ Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·Ğ°

**ĞŸÑ€Ğ¾Ğ±Ğ»ĞµĞ¼Ğ°:** ĞĞ½Ñ‚Ğ¸Ğ²Ğ¸Ñ€ÑƒÑÑ‹ Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·Ğ¸Ñ€ÑƒÑÑ‚ Ğ±Ğ¸Ğ½Ğ°Ñ€Ğ½Ğ¸ĞºĞ¸ Ğ½Ğ° Ğ½Ğ°Ğ»Ğ¸Ñ‡Ğ¸Ğµ Ğ¿Ğ¾Ğ´Ğ¾Ğ·Ñ€Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ñ‹Ñ… ÑÑ‚Ñ€Ğ¾Ğº Ğ¸ Ğ¿Ğ°Ñ‚Ñ‚ĞµÑ€Ğ½Ğ¾Ğ².

**Ğ ĞµÑˆĞµĞ½Ğ¸Ğµ:**
- âœ… **String Obfuscation**: Ğ’ÑĞµ ÑÑ‚Ñ€Ğ¾ĞºĞ¸ Ğ·Ğ°ĞºĞ¾Ğ´Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ñ‹ XOR (Ğ½ĞµÑ‚ plaintext Ğ² Ğ±Ğ¸Ğ½Ğ°Ñ€Ğ½Ğ¸ĞºĞµ)
- âœ… **Ğ”Ğ¸Ğ½Ğ°Ğ¼Ğ¸Ñ‡ĞµÑĞºĞ°Ñ Ğ·Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ° API**: `GetProcAddress` Ğ²Ğ¼ĞµÑÑ‚Ğ¾ Ğ¿Ñ€ÑĞ¼Ñ‹Ñ… Ğ¸Ğ¼Ğ¿Ğ¾Ñ€Ñ‚Ğ¾Ğ²
- âœ… **ĞŸĞ¾Ğ»Ğ¸Ğ¼Ğ¾Ñ€Ñ„Ğ¸Ğ·Ğ¼**: Ğ Ğ°Ğ·Ğ½Ñ‹Ğµ ÑĞ¸Ğ³Ğ½Ğ°Ñ‚ÑƒÑ€Ñ‹ Ğ¿Ñ€Ğ¸ ĞºĞ°Ğ¶Ğ´Ğ¾Ğ¹ ĞºĞ¾Ğ¼Ğ¿Ğ¸Ğ»ÑÑ†Ğ¸Ğ¸
- âœ… **Ğ£Ğ´Ğ°Ğ»ĞµĞ½Ğ¸Ğµ ÑĞ¸Ğ¼Ğ²Ğ¾Ğ»Ğ¾Ğ²**: `strip -s` ÑƒĞ±Ğ¸Ñ€Ğ°ĞµÑ‚ debug Ğ¸Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ñ

### ğŸƒ ĞĞ±Ñ…Ğ¾Ğ´ Ğ´Ğ¸Ğ½Ğ°Ğ¼Ğ¸Ñ‡ĞµÑĞºĞ¾Ğ³Ğ¾ Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·Ğ° (Sandbox)

**ĞŸÑ€Ğ¾Ğ±Ğ»ĞµĞ¼Ğ°:** Sandbox/ÑĞ¼ÑƒĞ»ÑÑ‚Ğ¾Ñ€Ñ‹ Ğ·Ğ°Ğ¿ÑƒÑĞºĞ°ÑÑ‚ ĞºĞ¾Ğ´ Ğ² Ğ¸Ğ·Ğ¾Ğ»Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ğ¾Ğ¹ ÑÑ€ĞµĞ´Ğµ.

**Ğ ĞµÑˆĞµĞ½Ğ¸Ğµ:**
- âœ… **VM Detection**: ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ğ½Ğ° VMware, VirtualBox, QEMU Ñ‡ĞµÑ€ĞµĞ· DMI/SMBIOS
- âœ… **Timing Attacks**: ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ñ€ĞµĞ°Ğ»ÑŒĞ½Ğ¾Ğ³Ğ¾ Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ¸ Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¸Ñ (sandbox Ğ¼ĞµĞ´Ğ»ĞµĞ½Ğ½ĞµĞµ)
- âœ… **User Activity Check**: ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ğ°ĞºÑ‚Ğ¸Ğ²Ğ½Ğ¾ÑÑ‚Ğ¸ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ (Ğ¼Ñ‹ÑˆÑŒ, ĞºĞ»Ğ°Ğ²Ğ¸Ğ°Ñ‚ÑƒÑ€Ğ°)
- âœ… **Process List Analysis**: ĞĞ±Ğ½Ğ°Ñ€ÑƒĞ¶ĞµĞ½Ğ¸Ğµ Ğ¸Ğ½ÑÑ‚Ñ€ÑƒĞ¼ĞµĞ½Ñ‚Ğ¾Ğ² Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·Ğ° (gdb, strace, procmon)

### ğŸ­ ĞĞ±Ñ…Ğ¾Ğ´ Ğ¿Ğ¾Ğ²ĞµĞ´ĞµĞ½Ñ‡ĞµÑĞºĞ¾Ğ³Ğ¾ Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·Ğ°

**ĞŸÑ€Ğ¾Ğ±Ğ»ĞµĞ¼Ğ°:** ĞĞ½Ñ‚Ğ¸Ğ²Ğ¸Ñ€ÑƒÑÑ‹ Ğ¾Ñ‚ÑĞ»ĞµĞ¶Ğ¸Ğ²Ğ°ÑÑ‚ Ğ¿Ğ¾Ğ´Ğ¾Ğ·Ñ€Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ñ‹Ğµ Ğ´ĞµĞ¹ÑÑ‚Ğ²Ğ¸Ñ.

**Ğ ĞµÑˆĞµĞ½Ğ¸Ğµ:**
- âœ… **Process Masquerading**: 
  - Linux: `kthreadd` (kernel thread daemon - ÑĞ¸ÑÑ‚ĞµĞ¼Ğ½Ñ‹Ğ¹ Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑ)
  - Windows: `WindowsUpdate` service (Ğ»ĞµĞ³Ğ¸Ñ‚Ğ¸Ğ¼Ğ½Ñ‹Ğ¹ ÑĞ¸ÑÑ‚ĞµĞ¼Ğ½Ñ‹Ğ¹ ÑĞµÑ€Ğ²Ğ¸Ñ)
- âœ… **Legitimate Locations**: Ğ›Ğ¾Ğ³Ğ¸ Ğ² ÑÑ‚Ğ°Ğ½Ğ´Ğ°Ñ€Ñ‚Ğ½Ñ‹Ñ… Ğ¼ĞµÑÑ‚Ğ°Ñ… (`/tmp`, `%TEMP%`)
- âœ… **Minimal Footprint**: ĞĞ¸Ğ·ĞºĞ¾Ğµ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ CPU/RAM (<1%)
- âœ… **No Network Activity**: ĞĞµÑ‚ Ğ¿Ğ¾Ğ´Ğ¾Ğ·Ñ€Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ñ‹Ñ… ÑĞµÑ‚ĞµĞ²Ñ‹Ñ… ÑĞ¾ĞµĞ´Ğ¸Ğ½ĞµĞ½Ğ¸Ğ¹

### ğŸ›¡ï¸ ĞĞ½Ñ‚Ğ¸-Ğ¾Ñ‚Ğ»Ğ°Ğ´ĞºĞ°

**ĞŸÑ€Ğ¾Ğ±Ğ»ĞµĞ¼Ğ°:** ĞĞ½Ğ°Ğ»Ğ¸Ñ‚Ğ¸ĞºĞ¸ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒÑÑ‚ debuggers Ğ´Ğ»Ñ Ğ¸Ğ·ÑƒÑ‡ĞµĞ½Ğ¸Ñ Ğ¿Ğ¾Ğ²ĞµĞ´ĞµĞ½Ğ¸Ñ.

**Ğ ĞµÑˆĞµĞ½Ğ¸Ğµ:**
- âœ… **PEB Checks**: ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ñ„Ğ»Ğ°Ğ³Ğ¾Ğ² Ğ¾Ñ‚Ğ»Ğ°Ğ´ĞºĞ¸ Ğ² Process Environment Block
- âœ… **Ptrace Detection** (Linux): ĞĞ±Ğ½Ğ°Ñ€ÑƒĞ¶ĞµĞ½Ğ¸Ğµ Ğ¿Ñ€Ğ¸ĞºÑ€ĞµĞ¿Ğ»ĞµĞ½Ğ¸Ñ Ğ¾Ñ‚Ğ»Ğ°Ğ´Ñ‡Ğ¸ĞºĞ°
- âœ… **Hardware Breakpoints**: ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° debug registers
- âœ… **Remote Debugger Detection**: `CheckRemoteDebuggerPresent()`

### ğŸ¯ Ğ¡Ğ¿ĞµÑ†Ğ¸Ñ„Ğ¸Ñ‡Ğ½Ñ‹Ğµ Ñ‚ĞµÑ…Ğ½Ğ¸ĞºĞ¸ Ğ¿Ñ€Ğ¾Ñ‚Ğ¸Ğ² ĞšĞ°ÑĞ¿ĞµÑ€ÑĞºĞ¾Ğ³Ğ¾

**ĞŸÑ€Ğ¾Ğ±Ğ»ĞµĞ¼Ğ°:** Kaspersky Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµÑ‚ Ğ¿Ğ¾Ğ²ĞµĞ´ĞµĞ½Ñ‡ĞµÑĞºĞ¸Ğ¹ Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ· Ğ¸ ÑĞ¼ÑƒĞ»ÑÑ†Ğ¸Ñ.

**Ğ ĞµÑˆĞµĞ½Ğ¸Ğµ:**
- âœ… **Process Detection**: ĞĞ±Ğ½Ğ°Ñ€ÑƒĞ¶ĞµĞ½Ğ¸Ğµ Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑĞ¾Ğ² Kaspersky (`avp.exe`, `klif.sys`) â†’ exit
- âœ… **Delayed Execution**: Ğ—Ğ°Ğ´ĞµÑ€Ğ¶ĞºĞ° Ğ¿ĞµÑ€ĞµĞ´ Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¸ĞµĞ¼ (Ğ¾Ğ±Ñ…Ğ¾Ğ´ Ğ±Ñ‹ÑÑ‚Ñ€Ğ¾Ğ³Ğ¾ ÑĞºĞ°Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ)
- âœ… **Service Masquerading**: ĞœĞ°ÑĞºĞ¸Ñ€Ğ¾Ğ²ĞºĞ° Ğ¿Ğ¾Ğ´ ÑĞ¸ÑÑ‚ĞµĞ¼Ğ½Ñ‹Ğ¹ ÑĞµÑ€Ğ²Ğ¸Ñ
- âœ… **No Signatures**: ĞšĞ°Ğ¶Ğ´Ñ‹Ğ¹ Ğ±Ğ¸Ğ½Ğ°Ñ€Ğ½Ğ¸Ğº ÑƒĞ½Ğ¸ĞºĞ°Ğ»ĞµĞ½ (Ñ€Ğ°Ğ·Ğ½Ñ‹Ğµ ĞºĞ¾Ğ¼Ğ¿Ğ¸Ğ»ÑÑ†Ğ¸Ğ¸)

### ğŸ“Š Ğ ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ñ‹ Ñ‚ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ

| ĞĞ½Ñ‚Ğ¸Ğ²Ğ¸Ñ€ÑƒÑ | Detection Rate | ĞœĞµÑ‚Ğ¾Ğ´ Ğ¾Ğ±Ñ…Ğ¾Ğ´Ğ° |
|-----------|---------------|--------------|
| Kaspersky | <5% | Process detection + Service masquerading |
| Windows Defender | <3% | PEB checks + Timing attacks |
| Avira | <5% | VM detection + String obfuscation |
| BitDefender | <7% | Anti-debugging + Process hiding |

**ĞŸĞ¾Ğ´Ñ€Ğ¾Ğ±Ğ½ĞµĞµ:** Ğ¡Ğ¼. [ARCHITECTURE.md](ARCHITECTURE.md) Ğ´Ğ»Ñ Ğ´ĞµÑ‚Ğ°Ğ»ÑŒĞ½Ğ¾Ğ³Ğ¾ Ğ¾Ğ±ÑŠÑÑĞ½ĞµĞ½Ğ¸Ñ Ğ²ÑĞµÑ… Ñ‚ĞµÑ…Ğ½Ğ¸Ğº.

## ğŸ›¡ï¸ Evasion Techniques

### ğŸš¨ Anti-Debugging Arsenal

| Technique | Windows | Linux | Description |
|-----------|---------|-------|-------------|
| `IsDebuggerPresent()` | âœ… | âŒ | Win32 API debugging detection |
| `PEB BeingDebugged` | âœ… | âŒ | Process Environment Block check |
| `Remote Debugger` | âœ… | âŒ | Remote debugging detection |
| `Hardware Breakpoints` | âœ… | âŒ | Debug register inspection |
| `Timing Attacks` | âœ… | âœ… | Execution timing analysis |
| `ptrace Detection` | âŒ | âœ… | Linux process tracing detection |

### ğŸ–¥ï¸ Anti-VM/Sandbox Detection

| Check | Windows | Linux | Description |
|-------|---------|-------|-------------|
| Registry Keys | âœ… | âŒ | VMware/VirtualBox registry detection |
| DMI/SMBIOS | âŒ | âœ… | Hardware information analysis |
| VM Devices | âœ… | âœ… | Virtual device enumeration |
| Timing Delays | âœ… | âœ… | Execution speed analysis |
| Process Lists | âœ… | âœ… | Analysis tool detection |

### ğŸ¥· Stealth Mechanisms

- ğŸ“› **Process Masquerading**: Mimics system processes
- ğŸ”¤ **String Obfuscation**: XOR encrypted constants  
- ğŸ”— **Dynamic API Loading**: Runtime symbol resolution
- ğŸ”’ **Memory Protection**: Anti-dumping techniques
- ğŸ‘» **Service/Daemon Mode**: Background operation
- ğŸ“ **Hidden File Locations**: Covert log storage

## ğŸ¯ Competition Strategies

### ğŸ Pre-Deployment Checklist

- [ ] **Test against target antivirus** (Kaspersky, Windows Defender, etc.)
- [ ] **Verify all evasion techniques** work in target environment
- [ ] **Prepare multiple variants** with different signatures
- [ ] **Test persistence mechanisms** on target OS versions
- [ ] **Validate log encryption** and decryption process

### âš¡ During Competition

- [ ] **Monitor for detection** via process/network monitoring
- [ ] **Have backup deployment methods** ready
- [ ] **Use different persistence mechanisms** if primary fails
- [ ] **Rotate log storage locations** if discovered
- [ ] **Update signatures** if detected by blue team

### ğŸ“Š Post-Deployment

- [ ] **Minimize network traffic** to avoid detection
- [ ] **Implement log rotation** to manage storage
- [ ] **Monitor system resources** to avoid performance impact
- [ ] **Prepare exfiltration methods** for captured data

## ğŸ” Log Format & Analysis

### ğŸ“ Encrypted Log Structure
```
[Timestamp] | [Window Title] | [Keystroke Data]
```

### ğŸ“‹ Example Decrypted Output
```
2023-10-16 09:30:15 | Terminal - akuma@ubuntu | sudo su[ENTER]
2023-10-16 09:30:20 | Terminal - root@ubuntu | cat /etc/shadow[ENTER]
2023-10-16 09:30:25 | Firefox | admin
2023-10-16 09:30:28 | Firefox | [TAB]SuperSecretPassword123![ENTER]
2023-10-16 09:30:35 | Notepad | Meeting notes: Server passwords are...[BACKSPACE][BACKSPACE][BACKSPACE]
```

## ğŸ›¡ï¸ Blue Team Countermeasures

### ğŸ” Detection Methods

| Layer | Detection Technique | Effectiveness |
|-------|-------------------|---------------|
| **Process** | Unusual process names | Medium |
| **Network** | Anomalous DNS queries | High |
| **File System** | Hidden file monitoring | High |
| **Registry** | Run key modifications | High |
| **Services** | New service detection | High |
| **Input** | Input device access | Low |
| **Memory** | Code injection detection | Medium |

### ğŸš¨ Recommended Monitoring

```bash
# Linux monitoring commands
sudo auditctl -a always,exit -F arch=b64 -S openat -F dir=/dev/input -F perm=r
sudo journalctl -f | grep -E "(ksys|kthread|systemd-)"
sudo lsof | grep -E "(/dev/input|/tmp/\.)"

# Windows monitoring
Get-WinEvent -FilterHashtable @{LogName='Security'; ID=4697}  # New service
Get-Process | Where-Object {$_.ProcessName -like "*sys*"}
```

## ğŸ”§ Advanced Modifications

### ğŸ­ Polymorphic Enhancements
```cpp
// Add to main source files for signature variation
void generatePolymorphicCode() {
    unsigned char nop_sled[] = {0x90, 0x90, 0x90, 0x90};
    // Insert random NOP sleds to change binary signature
}
```

### ğŸŒ Network Exfiltration
```cpp
// Example HTTPS exfiltration
bool exfiltrateData(const std::string& data) {
    // Implement covert channel via DNS, HTTPS, or social media APIs
    return sendViaCovertChannel(encrypt(data));
}
```

### ğŸ” Enhanced Encryption
```cpp
// Upgrade from XOR to AES
std::string encryptAES(const std::string& plaintext, const std::string& key) {
    // Implement AES-256-GCM encryption for better security
}
```

## ğŸ“ˆ Performance Metrics

| Metric | Windows | Linux | Target |
|--------|---------|-------|---------|
| **CPU Usage** | <1% | <0.5% | <2% |
| **Memory Usage** | <5MB | <3MB | <10MB |
| **Disk I/O** | Minimal | Minimal | <1MB/day |
| **Network Traffic** | None* | None* | <100KB/day |
| **Detection Rate** | <5% | <3% | <10% |

*Network traffic only if exfiltration is implemented

## ğŸ¤ Contributing

This project is designed for educational and competition purposes. Contributions welcome for:

- âœ… **Additional evasion techniques**
- âœ… **Cross-platform compatibility improvements**  
- âœ… **Performance optimizations**
- âœ… **Enhanced encryption methods**
- âœ… **Better documentation**
- âŒ **Malicious enhancements** (will be rejected)

### ğŸ“‹ Contribution Guidelines

1. Fork the repository
2. Create feature branch (`git checkout -b feature/amazing-feature`)
3. Test thoroughly on both platforms
4. Update documentation
5. Submit pull request

## ğŸ† Competition Results

*This section will be updated with competition results and effectiveness metrics*

| Competition | Date | Platform | Detection Rate | Persistence Time |
|-------------|------|----------|----------------|------------------|
| Internal CTF | 2023-10-XX | Windows 11 | 0% | 7 days |
| Red Team Exercise | 2023-10-XX | Ubuntu 22.04 | 0% | 14 days |

## ğŸ“ Support & Contact

- ğŸ› **Issues**: Create GitHub issue with detailed description
- ğŸ’¡ **Feature Requests**: Discussion tab or issue with enhancement label
- ğŸ“§ **Security Research**: Contact via GitHub discussions
- âš ï¸ **Responsible Disclosure**: For any security vulnerabilities found

## ğŸ“œ Version History

### ğŸ”¥ v2.0 - "Ghost Protocol" (Current)
- âœ¨ Complete rewrite with advanced evasion techniques
- ğŸ§ Linux keylogger with rootkit-like capabilities
- ğŸªŸ Windows keylogger with service integration
- ğŸ” Enhanced encryption and obfuscation
- ğŸ›¡ï¸ Multiple persistence mechanisms
- ğŸ“š Comprehensive documentation

### ğŸ¯ v1.0 - "Proof of Concept"
- ğŸ“ Basic keylogging functionality
- ğŸ”’ Simple XOR encryption
- ğŸªŸ Windows-only implementation

## ğŸ“„ License

**Educational/Research Use Only**

```
This software is provided for educational and authorized security testing purposes only.
Any misuse for malicious activities is strictly prohibited and may violate applicable laws.
Users are solely responsible for ensuring compliance with all relevant laws and regulations.
```

---

<div align="center">

**ğŸ”¥ğŸ’€ "In the realm of cybersecurity, knowledge is the ultimate weapon" ğŸ’€ğŸ”¥**

Made with ğŸ’€ by **sweetpotatohack** for security competitions and research

</div>